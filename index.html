<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>収支計算</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
input[type="number"], input[type="text"] {
    width: 100px;
    text-align: left;
    margin-right: 5px;
}
.clear-btn {
    padding: 2px 6px;
    font-size: 12px;
    margin-left: 2px;
}
label {
    display: inline-block;
    width: 120px;
    text-align: left;
}
.output {
    text-align: center;
    font-family: monospace;
    white-space: pre;
}
.output-line {
    display: block;
    text-align: left;
    margin: 2px auto;
    width: fit-content;
}

        body {
            font-family: sans-serif;
            margin: 10px;
            padding: 0;
            background-color: #f5f5f5;
        }
        h1 {
            font-size: 20px;
            text-align: center;
            margin-bottom: 10px;
        }
        .container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-width: 100%;
            overflow-x: hidden;
        }
        .row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }
        .row label {
            white-space: nowrap;
            flex-shrink: 0;
        }
        .row input[type="number"] {
            width: 100px;
            padding: 2px;
            font-size: 14px;
        }
        .clear-btn {
            padding: 0 6px;
            font-size: 12px;
            cursor: pointer;
            background-color: #ccc;
            border: none;
            border-radius: 3px;
        }
        button {
            padding: 8px;
            font-size: 16px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            margin: 10px 0;
        }
        .results {
            font-size: 14px;
            background: white;
            padding: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>収支計算</h1>
    <div class="container">
        <div class="row"><label>物件価格</label><input type="number" id="propertyPrice" value="60000000"><button class="clear-btn" onclick="clearInput('propertyPrice')">×</button></div>
        <div class="row"><label>年間想定年収</label><input type="number" id="annualIncome" value="7592400"><button class="clear-btn" onclick="clearInput('annualIncome')">×</button></div>
        <div class="row"><label>自己資金</label><input type="number" id="ownCapital" value="5000000"><button class="clear-btn" onclick="clearInput('ownCapital')">×</button></div>
        <div class="row"><label>空室率 (%)</label><input type="number" id="vacancyRate" value="10"><button class="clear-btn" onclick="clearInput('vacancyRate')">×</button></div>
        <div class="row"><label>諸経費率 (%)</label><input type="number" id="expensesRate" value="15"><button class="clear-btn" onclick="clearInput('expensesRate')">×</button></div>
        <div class="row"><label>借入期間 (年)</label><input type="number" id="loanPeriod" value="15"><button class="clear-btn" onclick="clearInput('loanPeriod')">×</button></div>
        <div class="row"><label>借入金利 (%)</label><input type="number" id="interestRate" value="3"><button class="clear-btn" onclick="clearInput('interestRate')">×</button></div>
        <button onclick="calculate()">ご試算</button>
        <div class="results" id="results"></div>
    </div>

    <script>
        function clearInput(id) {
            document.getElementById(id).value = "";
        }

        function formatYen(num) {
            return Number(num).toLocaleString("ja-JP", { style: "currency", currency: "JPY" });
        }

        function calculate() {
            const P = parseFloat(document.getElementById('propertyPrice').value);
            const Y = parseFloat(document.getElementById('annualIncome').value);
            const C = parseFloat(document.getElementById('ownCapital').value);
            const V = parseFloat(document.getElementById('vacancyRate').value) / 100;
            const E = parseFloat(document.getElementById('expensesRate').value) / 100;
            const T = parseFloat(document.getElementById('loanPeriod').value);
            const R = parseFloat(document.getElementById('interestRate').value) / 100;

            const B = P - C; // 借入金額
            const n = T * 12;
            const i = R / 12;
            const A = B * i * Math.pow(1 + i, n) / (Math.pow(1 + i, n) - 1);
            const annualRepayment = A * 12;
            const totalRepayment = A * n;

            const netAnnualRent = Y * (1 - V);
            const expenses = netAnnualRent * E;
            const annualOutflow = annualRepayment + expenses;
            const netIncome = netAnnualRent - expenses - annualRepayment;

            const surfaceYield = Y / P * 100;
            const realYield = netAnnualRent / P * 100;
            const yieldAfterRepayment = netIncome / P * 100;
            const investmentYield = netIncome / C * 100;

            document.getElementById("results").innerHTML = `
                返済額（月額）：${formatYen(A.toFixed(0))}<br>
                返済額（年額）：${formatYen(annualRepayment.toFixed(0))}<br>
                返済総額：${formatYen(totalRepayment.toFixed(0))}<br>
                家賃収入（年額）：${formatYen(netAnnualRent.toFixed(0))}<br>
                控除・諸経費（年額）：${formatYen(expenses.toFixed(0))}<br>
                年間支出：${formatYen(annualOutflow.toFixed(0))}<br>
                年間手取り：${formatYen(netIncome.toFixed(0))}<br>
                表面利回り：${surfaceYield.toFixed(2)}%<br>
                実質利回り：${realYield.toFixed(2)}%<br>
                返済後利回り：${yieldAfterRepayment.toFixed(2)}%<br>
                投資利回り：${investmentYield.toFixed(2)}%
            `;
        }
    </script>
</body>
</html>
